<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SwiftPurse - Transactions</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      /* Global Styles */
      :root {
        --primary-gradient: linear-gradient(135deg, #5a189a 0%, #10002b 100%);
        --secondary-gradient: linear-gradient(135deg, #10002b 0%, #5a189a 100%);
        --accent-gradient: linear-gradient(135deg, #f15bb5 0%, #9b5de5 100%);
        --dark-gradient: #10002b;
        --glass-bg: rgba(255, 255, 255, 0.1);
        --glass-border: rgba(255, 255, 255, 0.2);
        --text-primary: #ffffff;
        --text-secondary: rgba(255, 255, 255, 0.8);
        --success-color: #38b000;
        --error-color: #d00000;
        --warning-color: #ffaa00;
        --bitcoin-color: #f7931a;
        --ethereum-color: #627eea;
        --cardano-color: #0033ad;
        --solana-color: #00ffbd;
        --ripple-color: #27a2db;
        --usdt-color: #26a17b;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: var(--dark-gradient);
        min-height: 100vh;
        color: var(--text-primary);
        overflow-x: hidden;
      }

      /* Animated Background */
      .bg-animation {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        opacity: 0.1;
      }

      .floating-shapes {
        position: absolute;
        width: 100%;
        height: 100%;
      }

      .shape {
        position: absolute;
        border-radius: 50%;
        background: var(--accent-gradient);
        animation: float 20s infinite linear;
      }

      .shape:nth-child(1) {
        width: 80px;
        height: 80px;
        left: 10%;
        animation-delay: 0s;
      }
      .shape:nth-child(2) {
        width: 120px;
        height: 120px;
        left: 80%;
        animation-delay: 5s;
      }
      .shape:nth-child(3) {
        width: 60px;
        height: 60px;
        left: 50%;
        animation-delay: 10s;
      }
      .shape:nth-child(4) {
        width: 100px;
        height: 100px;
        left: 20%;
        animation-delay: 15s;
      }

      @keyframes float {
        0% {
          transform: translateY(100vh) rotate(0deg);
          opacity: 0;
        }
        10% {
          opacity: 1;
        }
        90% {
          opacity: 1;
        }
        100% {
          transform: translateY(-100px) rotate(360deg);
          opacity: 0;
        }
      }

      /* Loader */
      .loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--dark-gradient);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        transition: opacity 0.5s ease-out;
      }

      .loader-content {
        text-align: center;
        color: var(--text-primary);
      }

      .loader-ring {
        width: 80px;
        height: 80px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-top: 4px solid #fff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .loader-text {
        font-size: 18px;
        font-weight: 600;
        animation: pulse 2s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      /* Header */
      .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        padding: 15px 30px;
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--glass-border);
        z-index: 1000;
        animation: slideDown 0.8s ease-out;
      }

      @keyframes slideDown {
        from {
          transform: translateY(-100%);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .nav-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        max-width: 1200px;
        margin: 0 auto;
      }

      .logo-container {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        transition: transform 0.3s ease;
      }

      .logo:hover {
        transform: scale(1.1) rotate(5deg);
      }

      .brand-name {
        font-size: 24px;
        font-weight: 700;
        color: var(--text-primary);
        background: var(--accent-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .nav-menu {
        display: flex;
        gap: 30px;
        align-items: center;
      }

      .nav-link {
        color: var(--text-secondary);
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        position: relative;
      }

      .nav-link:hover {
        color: var(--text-primary);
        transform: translateY(-2px);
      }

      .nav-link::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--accent-gradient);
        transition: width 0.3s ease;
      }

      .nav-link:hover::after {
        width: 100%;
      }

      .mobile-menu-toggle {
        display: none;
        background: none;
        border: none;
        color: var(--text-primary);
        font-size: 24px;
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      .mobile-menu-toggle:hover {
        transform: scale(1.1);
      }

      .mobile-menu {
        position: fixed;
        top: 0;
        right: -100%;
        width: 300px;
        height: 100vh;
        background: #10002b;
        backdrop-filter: blur(20px);
        padding: 80px 30px 30px;
        transition: right 0.3s ease;
        z-index: 999;
      }

      .mobile-menu.active {
        right: 0;
      }

      .mobile-menu .nav-link {
        display: block;
        padding: 15px 0;
        font-size: 18px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      /* Main Content */
      .main-content {
        min-height: 100vh;
        padding: 120px 20px 50px;
        max-width: 1200px;
        margin: 0 auto;
      }

      /* Page Header */
      .page-header {
        text-align: center;
        margin-bottom: 40px;
        animation: fadeIn 0.8s ease-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .page-title {
        font-size: 32px;
        margin-bottom: 15px;
        background: var(--accent-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .page-subtitle {
        color: var(--text-secondary);
        font-size: 16px;
        max-width: 600px;
        margin: 0 auto;
      }

      /* Stats Cards */
      .stats-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: var(--glass-bg);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 20px;
        border: 1px solid var(--glass-border);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        animation: slideUp 0.8s ease-out;
      }

      @keyframes slideUp {
        from {
          transform: translateY(20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
      }

      .stat-card::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        animation: rotate 15s linear infinite;
        z-index: -1;
      }

      @keyframes rotate {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      .stat-title {
        font-size: 14px;
        color: var(--text-secondary);
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .stat-value {
        font-size: 28px;
        font-weight: 700;
        margin-bottom: 5px;
      }

      .stat-change {
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .stat-change.positive {
        color: var(--success-color);
      }

      .stat-change.negative {
        color: var(--error-color);
      }

      /* Chart Container */
      .chart-container {
        background: var(--glass-bg);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 20px;
        border: 1px solid var(--glass-border);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        margin-bottom: 30px;
        animation: fadeIn 0.8s ease-out 0.2s both;
      }

      .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .chart-title {
        font-size: 18px;
        font-weight: 600;
      }

      .chart-controls {
        display: flex;
        gap: 10px;
      }

      .chart-btn {
        padding: 6px 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--glass-border);
        border-radius: 8px;
        color: var(--text-secondary);
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .chart-btn.active {
        background: var(--accent-gradient);
        color: white;
        border-color: transparent;
      }

      .chart-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .chart-wrapper {
        position: relative;
        height: 300px;
        width: 100%;
      }

      /* Filters */
      .filters-container {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 30px;
        animation: fadeIn 0.8s ease-out 0.4s both;
      }

      .filter-group {
        flex: 1;
        min-width: 200px;
      }

      .filter-label {
        display: block;
        margin-bottom: 8px;
        font-size: 14px;
        color: var(--text-secondary);
      }

      .filter-select {
        width: 100%;
        padding: 10px 15px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--glass-border);
        border-radius: 10px;
        color: var(--text-primary);
        font-size: 14px;
        transition: all 0.3s ease;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 16px;
      }

      .filter-select:focus {
        outline: none;
        border-color: var(--text-primary);
        box-shadow: 0 0 0 3px rgba(241, 91, 181, 0.2);
      }

      .filter-btn {
        padding: 10px 20px;
        background: var(--accent-gradient);
        border: none;
        border-radius: 10px;
        color: white;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .filter-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      .filter-btn.reset {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--glass-border);
      }

      /* Transactions Table */
      .transactions-container {
        background: var(--glass-bg);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 20px;
        border: 1px solid var(--glass-border);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        animation: fadeIn 0.8s ease-out 0.6s both;
      }

      .transactions-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .transactions-title {
        font-size: 18px;
        font-weight: 600;
      }

      .transactions-actions {
        display: flex;
        gap: 10px;
      }

      .transactions-btn {
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--glass-border);
        border-radius: 8px;
        color: var(--text-secondary);
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .transactions-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .transactions-table {
        width: 100%;
        border-collapse: collapse;
      }

      .transactions-table thead th {
        padding: 12px 15px;
        text-align: left;
        font-weight: 600;
        color: var(--text-secondary);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .transactions-table tbody tr {
        transition: all 0.3s ease;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      }

      .transactions-table tbody tr:last-child {
        border-bottom: none;
      }

      .transactions-table tbody tr:hover {
        background: rgba(255, 255, 255, 0.05);
      }

      .transactions-table td {
        padding: 15px;
        vertical-align: middle;
      }

      .transaction-type {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .transaction-icon {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
      }

      .transaction-icon.deposit {
        background: rgba(56, 176, 0, 0.2);
        color: var(--success-color);
      }

      .transaction-icon.withdrawal {
        background: rgba(208, 0, 0, 0.2);
        color: var(--error-color);
      }

      .transaction-icon.swap {
        background: rgba(155, 93, 229, 0.2);
        color: #9b5de5;
      }

      .transaction-icon.game {
        background: rgba(241, 91, 181, 0.2);
        color: #f15bb5;
      }

      .transaction-details {
        display: flex;
        flex-direction: column;
      }

      .transaction-title {
        font-weight: 600;
        margin-bottom: 3px;
      }

      .transaction-subtitle {
        font-size: 12px;
        color: var(--text-secondary);
      }

      .transaction-amount {
        font-weight: 600;
        text-align: right;
      }

      .transaction-amount.positive {
        color: var(--success-color);
      }

      .transaction-amount.negative {
        color: var(--error-color);
      }

      .transaction-status {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
      }

      .transaction-status.completed {
        background: rgba(56, 176, 0, 0.2);
        color: var(--success-color);
      }

      .transaction-status.pending {
        background: rgba(255, 170, 0, 0.2);
        color: var(--warning-color);
      }

      .transaction-status.failed {
        background: rgba(208, 0, 0, 0.2);
        color: var(--error-color);
      }

      .transaction-actions {
        display: flex;
        gap: 8px;
        justify-content: flex-end;
      }

      .transaction-btn {
        background: none;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        transition: all 0.3s ease;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .transaction-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--text-primary);
      }

      /* Empty State */
      .empty-state {
        text-align: center;
        padding: 40px 20px;
        color: var(--text-secondary);
      }

      .empty-icon {
        font-size: 48px;
        margin-bottom: 15px;
        color: rgba(255, 255, 255, 0.2);
      }

      .empty-title {
        font-size: 18px;
        margin-bottom: 10px;
      }

      .empty-message {
        font-size: 14px;
        margin-bottom: 20px;
      }

      /* Pagination */
      .pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
        margin-top: 30px;
      }

      .pagination-btn {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--glass-border);
        color: var(--text-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .pagination-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .pagination-btn.active {
        background: var(--accent-gradient);
        border-color: transparent;
      }

      .pagination-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* Transaction Details Modal */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(10px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .modal-content {
        background: var(--dark-gradient);
        border-radius: 20px;
        padding: 30px;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        transform: translateY(20px);
        transition: all 0.3s ease;
        border: 1px solid var(--glass-border);
      }

      .modal-overlay.active .modal-content {
        transform: translateY(0);
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .modal-title {
        font-size: 22px;
        font-weight: 700;
        background: var(--accent-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .modal-close {
        background: none;
        border: none;
        color: var(--text-secondary);
        font-size: 24px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .modal-close:hover {
        color: var(--text-primary);
        transform: rotate(90deg);
      }

      .modal-body {
        margin-bottom: 30px;
      }

      .transaction-detail {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .transaction-detail:last-child {
        border-bottom: none;
        margin-bottom: 0;
        padding-bottom: 0;
      }

      .detail-label {
        color: var(--text-secondary);
        font-size: 14px;
      }

      .detail-value {
        font-weight: 600;
        text-align: right;
        max-width: 60%;
        word-break: break-word;
      }

      .detail-value.positive {
        color: var(--success-color);
      }

      .detail-value.negative {
        color: var(--error-color);
      }

      .modal-actions {
        display: flex;
        gap: 15px;
      }

      .modal-btn {
        flex: 1;
        padding: 12px;
        border-radius: 10px;
        border: none;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .modal-btn.primary {
        background: var(--accent-gradient);
        color: white;
      }

      .modal-btn.secondary {
        background: var(--glass-bg);
        color: var(--text-primary);
        border: 1px solid var(--glass-border);
      }

      .modal-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }

      /* Export Modal */
      .export-modal {
        background: var(--dark-gradient);
        border-radius: 20px;
        padding: 30px;
        max-width: 500px;
        width: 90%;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        transform: translateY(20px);
        transition: all 0.3s ease;
        border: 1px solid var(--glass-border);
      }

      .export-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 15px;
        margin: 20px 0;
      }

      .export-option {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        padding: 15px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 1px solid var(--glass-border);
      }

      .export-option:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateY(-3px);
      }

      .export-option.active {
        background: var(--accent-gradient);
        border-color: transparent;
      }

      .export-icon {
        font-size: 24px;
        margin-bottom: 10px;
      }

      /* Notification */
      .custom-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 350px;
        padding: 15px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        z-index: 10000;
        transform: translateX(100%);
        transition: transform 0.3s ease-out;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .custom-notification.success {
        background: rgba(56, 176, 0, 0.2);
        border-left: 4px solid var(--success-color);
      }

      .custom-notification.error {
        background: rgba(208, 0, 0, 0.2);
        border-left: 4px solid var(--error-color);
      }

      .custom-notification.warning {
        background: rgba(255, 170, 0, 0.2);
        border-left: 4px solid var(--warning-color);
      }

      .notification-icon {
        font-size: 24px;
      }

      .notification-icon i {
        display: flex;
      }

      .success .notification-icon {
        color: var(--success-color);
      }

      .error .notification-icon {
        color: var(--error-color);
      }

      .warning .notification-icon {
        color: var(--warning-color);
      }

      .notification-content {
        flex: 1;
      }

      .notification-title {
        font-weight: 600;
        margin-bottom: 5px;
      }

      .notification-message {
        font-size: 14px;
        opacity: 0.8;
      }

      .notification-close {
        background: none;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        padding: 5px;
        font-size: 14px;
        transition: color 0.3s ease;
      }

      .notification-close:hover {
        color: var(--text-primary);
      }

      /* Ripple effect */
      .ripple {
        position: absolute;
        border-radius: 50%;
        background-color: rgba(255, 255, 255, 0.3);
        transform: scale(0);
        animation: ripple-animation 0.6s linear;
        pointer-events: none;
      }

      @keyframes ripple-animation {
        to {
          transform: scale(4);
          opacity: 0;
        }
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .nav-menu {
          display: none;
        }

        .mobile-menu-toggle {
          display: block;
        }

        .main-content {
          padding: 100px 15px 30px;
        }

        .stats-container {
          grid-template-columns: 1fr;
        }

        .chart-controls {
          flex-wrap: wrap;
        }

        .transactions-table thead {
          display: none;
        }

        .transactions-table tbody tr {
          display: block;
          padding: 15px;
          border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .transactions-table td {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 8px 0;
          border: none;
        }

        .transactions-table td::before {
          content: attr(data-label);
          font-weight: 600;
          color: var(--text-secondary);
          margin-right: 15px;
        }

        .transaction-actions {
          justify-content: center;
          margin-top: 15px;
        }

        .modal-actions {
          flex-direction: column;
        }

        .export-options {
          grid-template-columns: 1fr 1fr;
        }
      }

      @media (max-width: 480px) {
        .header {
          padding: 15px 20px;
        }

        .page-title {
          font-size: 24px;
        }

        .page-subtitle {
          font-size: 14px;
        }

        .filters-container {
          flex-direction: column;
        }

        .filter-group {
          min-width: 100%;
        }

        .transactions-actions {
          flex-direction: column;
          align-items: flex-end;
        }

        .modal-content {
          padding: 20px;
        }

        .export-options {
          grid-template-columns: 1fr;
        }

        .custom-notification {
          width: calc(100% - 40px);
          right: 20px;
          left: 20px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Loader -->
    <div class="loader" id="loader">
      <div class="loader-content">
        <div class="loader-ring"></div>
        <div class="loader-text">Loading Transactions...</div>
      </div>
    </div>

    <!-- Animated Background -->
    <div class="bg-animation">
      <div class="floating-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
      </div>
    </div>

    <!-- Header -->
    <header class="header">
      <div class="nav-container">
        <div class="logo-container">
          <img
            src="https://codehubme.wordpress.com/wp-content/uploads/2025/06/file_00000000882c62439bbd2b1da125b80a_1-removebg-preview5089134587099523797.png"
            alt="SwiftPurse Logo"
            class="logo"
          />
          <span class="brand-name">SwiftPurse</span>
        </div>
        <nav class="nav-menu">
          <a href="dashboard.html" class="nav-link">Dashboard</a>
          <a href="transaction.html" class="nav-link active">Transactions</a>
          <a href="Guess.html" class="nav-link">Guess & Win</a>
          <a href="setting.html" class="nav-link">Settings</a>
          <a href="swap.html" class="nav-link">Swap NGN to $$</a>
        </nav>
        <button class="mobile-menu-toggle" id="mobileMenuToggle">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </header>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
      <a href="dashboard.html" class="nav-link">Dashboard</a>
      <a href="transaction.html" class="nav-link active">Transactions</a>
      <a href="Guess.html" class="nav-link">Guess & Win</a>
      <a href="setting.html" class="nav-link">Settings</a>
      <a href="swap.html" class="nav-link">Swap NGN to $$</a>
    </div>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Page Header -->
      <section class="page-header">
        <h1 class="page-title">Transaction History</h1>
        <p class="page-subtitle">
          View all your deposits, withdrawals, swaps, and game transactions in
          one place.
        </p>
      </section>

      <!-- Stats Cards -->
      <section class="stats-container">
        <div class="stat-card">
          <div class="stat-title">
            <i class="fas fa-arrow-down"></i> Total Deposits
          </div>
          <div class="stat-value" id="totalDeposits">$0.00</div>
          <div class="stat-change positive">
            <i class="fas fa-arrow-up"></i> 12.5% from last month
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-title">
            <i class="fas fa-arrow-up"></i> Total Withdrawals
          </div>
          <div class="stat-value" id="totalWithdrawals">$0.00</div>
          <div class="stat-change negative">
            <i class="fas fa-arrow-down"></i> 5.3% from last month
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-title">
            <i class="fas fa-exchange-alt"></i> Total Swaps
          </div>
          <div class="stat-value" id="totalSwaps">$0.00</div>
          <div class="stat-change positive">
            <i class="fas fa-arrow-up"></i> 24.7% from last month
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-title">
            <i class="fas fa-gamepad"></i> Game Winnings
          </div>
          <div class="stat-value" id="totalWinnings">$0.00</div>
          <div class="stat-change positive">
            <i class="fas fa-arrow-up"></i> 8.2% from last month
          </div>
        </div>
      </section>

      <!-- Chart Container -->
      <section class="chart-container">
        <div class="chart-header">
          <div class="chart-title">Transaction Activity</div>
          <div class="chart-controls">
            <button class="chart-btn active" data-period="7d">7 Days</button>
            <button class="chart-btn" data-period="30d">30 Days</button>
            <button class="chart-btn" data-period="90d">90 Days</button>
            <button class="chart-btn" data-period="1y">1 Year</button>
          </div>
        </div>
        <div class="chart-wrapper">
          <canvas id="transactionChart"></canvas>
        </div>
      </section>

      <!-- Filters -->
      <section class="filters-container">
        <div class="filter-group">
          <label for="typeFilter" class="filter-label">Transaction Type</label>
          <select id="typeFilter" class="filter-select">
            <option value="all">All Types</option>
            <option value="deposit">Deposits</option>
            <option value="withdrawal">Withdrawals</option>
            <option value="swap">Swaps</option>
            <option value="game">Games</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="statusFilter" class="filter-label">Status</label>
          <select id="statusFilter" class="filter-select">
            <option value="all">All Statuses</option>
            <option value="completed">Completed</option>
            <option value="pending">Pending</option>
            <option value="failed">Failed</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="dateFilter" class="filter-label">Date Range</label>
          <select id="dateFilter" class="filter-select">
            <option value="all">All Time</option>
            <option value="7d">Last 7 Days</option>
            <option value="30d">Last 30 Days</option>
            <option value="90d">Last 90 Days</option>
            <option value="1y">Last Year</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="amountFilter" class="filter-label">Amount Range</label>
          <select id="amountFilter" class="filter-select">
            <option value="all">All Amounts</option>
            <option value="0-100">$0 - $100</option>
            <option value="100-500">$100 - $500</option>
            <option value="500-1000">$500 - $1000</option>
            <option value="1000+">$1000+</option>
          </select>
        </div>
        <button class="filter-btn" id="applyFilters">
          <i class="fas fa-filter"></i> Apply Filters
        </button>
        <button class="filter-btn reset" id="resetFilters">
          <i class="fas fa-redo"></i> Reset
        </button>
      </section>

      <!-- Transactions Table -->
      <section class="transactions-container">
        <div class="transactions-header">
          <div class="transactions-title">Recent Transactions</div>
          <div class="transactions-actions">
            <button class="transactions-btn" id="exportBtn">
              <i class="fas fa-file-export"></i> Export
            </button>
            <button class="transactions-btn" id="refreshBtn">
              <i class="fas fa-sync-alt"></i> Refresh
            </button>
          </div>
        </div>
        <div class="transactions-table-wrapper">
          <table class="transactions-table">
            <thead>
              <tr>
                <th>Transaction</th>
                <th>Amount</th>
                <th>Date</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="transactionsBody">
              <!-- Transactions will be loaded here -->
            </tbody>
          </table>
          <div class="empty-state" id="emptyState" style="display: none">
            <div class="empty-icon">
              <i class="fas fa-exchange-alt"></i>
            </div>
            <div class="empty-title">No Transactions Found</div>
            <div class="empty-message">
              Your transaction history will appear here once you make your first
              transaction.
            </div>
            <button class="filter-btn" id="exploreBtn">
              <i class="fas fa-arrow-right"></i> Explore SwiftPurse
            </button>
          </div>
        </div>
        <div class="pagination" id="pagination">
          <!-- Pagination will be loaded here -->
        </div>
      </section>
    </main>

    <!-- Transaction Details Modal -->
    <div class="modal-overlay" id="transactionModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">Transaction Details</h3>
          <button class="modal-close" id="closeModal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="transaction-detail">
            <div class="detail-label">Transaction ID</div>
            <div class="detail-value" id="detailId">SWP-XXXX-XXXX-XXXX</div>
          </div>
          <div class="transaction-detail">
            <div class="detail-label">Type</div>
            <div class="detail-value" id="detailType">Deposit</div>
          </div>
          <div class="transaction-detail">
            <div class="detail-label">Amount</div>
            <div class="detail-value positive" id="detailAmount">+$100.00</div>
          </div>
          <div class="transaction-detail">
            <div class="detail-label">Date & Time</div>
            <div class="detail-value" id="detailDate">Jan 1, 2025 12:00 PM</div>
          </div>
          <div class="transaction-detail">
            <div class="detail-label">Status</div>
            <div class="detail-value" id="detailStatus">Completed</div>
          </div>
          <div class="transaction-detail">
            <div class="detail-label">Description</div>
            <div class="detail-value" id="detailDescription">
              Deposit from Bank Transfer
            </div>
          </div>
          <div class="transaction-detail">
            <div class="detail-label">Reference</div>
            <div class="detail-value" id="detailReference">BANK-XXXXXX</div>
          </div>
        </div>
        <div class="modal-actions">
          <button class="modal-btn primary" id="receiptBtn">
            <i class="fas fa-receipt"></i> View Receipt
          </button>
          <button class="modal-btn secondary" id="closeDetailBtn">
            <i class="fas fa-times"></i> Close
          </button>
        </div>
      </div>
    </div>

    <!-- Export Modal -->
    <div class="modal-overlay" id="exportModal">
      <div class="export-modal">
        <div class="modal-header">
          <h3 class="modal-title">Export Transactions</h3>
          <button class="modal-close" id="closeExportModal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <p>Select the format you want to export your transactions in:</p>
          <div class="export-options">
            <div class="export-option" data-format="csv">
              <div class="export-icon">
                <i class="fas fa-file-csv"></i>
              </div>
              <div>CSV</div>
            </div>
            <div class="export-option" data-format="pdf">
              <div class="export-icon">
                <i class="fas fa-file-pdf"></i>
              </div>
              <div>PDF</div>
            </div>
            <div class="export-option" data-format="excel">
              <div class="export-icon">
                <i class="fas fa-file-excel"></i>
              </div>
              <div>Excel</div>
            </div>
            <div class="export-option" data-format="print">
              <div class="export-icon">
                <i class="fas fa-print"></i>
              </div>
              <div>Print</div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button class="modal-btn primary" id="confirmExport">
            <i class="fas fa-download"></i> Export
          </button>
          <button class="modal-btn secondary" id="cancelExport">
            <i class="fas fa-times"></i> Cancel
          </button>
        </div>
      </div>
    </div>

    <script>
      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyBNtrsRJoq82G4vSJnNLtcuIgGNMQu7dsw",
        authDomain: "ecommerce-79bf2.firebaseapp.com",
        databaseURL: "https://ecommerce-79bf2-default-rtdb.firebaseio.com/",
        projectId: "ecommerce-79bf2",
        storageBucket: "ecommerce-79bf2.appspot.com",
        messagingSenderId: "420163739618",
        appId: "1:420163739618:android:45d0da5b4acf0fff9663bb",
      };

      // Initialize Firebase
      const app = firebase.initializeApp(firebaseConfig);
      const database = firebase.database();

      // Global variables
      let userId = "";
      let transactions = [];
      let filteredTransactions = [];
      let currentPage = 1;
      const transactionsPerPage = 10;
      let selectedFormat = "csv";
      let transactionChart = null;

      // DOM elements
      const loader = document.getElementById("loader");
      const mobileMenuToggle = document.getElementById("mobileMenuToggle");
      const mobileMenu = document.getElementById("mobileMenu");
      const transactionsBody = document.getElementById("transactionsBody");
      const emptyState = document.getElementById("emptyState");
      const pagination = document.getElementById("pagination");
      const applyFiltersBtn = document.getElementById("applyFilters");
      const resetFiltersBtn = document.getElementById("resetFilters");
      const exportBtn = document.getElementById("exportBtn");
      const refreshBtn = document.getElementById("refreshBtn");
      const exploreBtn = document.getElementById("exploreBtn");
      const transactionModal = document.getElementById("transactionModal");
      const closeModalBtn = document.getElementById("closeModal");
      const closeDetailBtn = document.getElementById("closeDetailBtn");
      const receiptBtn = document.getElementById("receiptBtn");
      const exportModal = document.getElementById("exportModal");
      const closeExportModal = document.getElementById("closeExportModal");
      const confirmExport = document.getElementById("confirmExport");
      const cancelExport = document.getElementById("cancelExport");
      const exportOptions = document.querySelectorAll(".export-option");
      const chartBtns = document.querySelectorAll(".chart-btn");
      const transactionChartCanvas =
        document.getElementById("transactionChart");

      // When DOM is loaded
      document.addEventListener("DOMContentLoaded", function () {
        // Check if user is logged in
        userId = sessionStorage.getItem("swiftPurseUserId");
        if (!userId) {
          window.location.href = "login.html";
          return;
        }

        // Initialize mobile menu toggle
        mobileMenuToggle.addEventListener("click", function () {
          mobileMenu.classList.toggle("active");
          const icon = this.querySelector("i");
          if (mobileMenu.classList.contains("active")) {
            icon.classList.remove("fa-bars");
            icon.classList.add("fa-times");
          } else {
            icon.classList.remove("fa-times");
            icon.classList.add("fa-bars");
          }
        });

        // Close mobile menu when clicking outside
        document.addEventListener("click", function (e) {
          if (
            !mobileMenu.contains(e.target) &&
            !mobileMenuToggle.contains(e.target)
          ) {
            mobileMenu.classList.remove("active");
            const icon = mobileMenuToggle.querySelector("i");
            icon.classList.remove("fa-times");
            icon.classList.add("fa-bars");
          }
        });

        // Load transactions
        loadTransactions();

        // Set up filter buttons
        applyFiltersBtn.addEventListener("click", applyFilters);
        resetFiltersBtn.addEventListener("click", resetFilters);

        // Set up export button
        exportBtn.addEventListener("click", () => {
          exportModal.classList.add("active");
        });

        // Set up export options
        exportOptions.forEach((option) => {
          option.addEventListener("click", () => {
            exportOptions.forEach((opt) => opt.classList.remove("active"));
            option.classList.add("active");
            selectedFormat = option.dataset.format;
          });
        });

        // Set up export modal buttons
        closeExportModal.addEventListener("click", () => {
          exportModal.classList.remove("active");
        });
        cancelExport.addEventListener("click", () => {
          exportModal.classList.remove("active");
        });
        confirmExport.addEventListener("click", exportTransactions);

        // Set up refresh button
        refreshBtn.addEventListener("click", loadTransactions);

        // Set up explore button
        exploreBtn.addEventListener("click", () => {
          window.location.href = "dashboard.html";
        });

        // Set up chart period buttons
        chartBtns.forEach((btn) => {
          btn.addEventListener("click", () => {
            chartBtns.forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            updateChart(btn.dataset.period);
          });
        });

        // Set up modal close buttons
        closeModalBtn.addEventListener("click", () => {
          transactionModal.classList.remove("active");
        });
        closeDetailBtn.addEventListener("click", () => {
          transactionModal.classList.remove("active");
        });

        // Set up receipt button
        receiptBtn.addEventListener("click", () => {
          showNotification(
            "success",
            "Receipt Downloaded",
            "Your transaction receipt has been downloaded."
          );
          transactionModal.classList.remove("active");
        });

        // Add ripple effect to buttons
        document.querySelectorAll("button").forEach((button) => {
          button.addEventListener("click", createRipple);
        });
      });

      // Load transactions from Firebase
      function loadTransactions() {
        // Show loader
        loader.style.display = "flex";
        loader.style.opacity = "1";

        // Get transactions from Firebase
        const transactionsRef = database.ref(`swifttransactions/${userId}`);
        transactionsRef.once("value").then((snapshot) => {
          const transactionsData = snapshot.val();
          transactions = [];

          if (transactionsData) {
            // Convert to array and sort by date (newest first)
            transactions = Object.entries(transactionsData)
              .map(([key, value]) => ({
                id: key,
                ...value,
              }))
              .sort((a, b) => {
                const dateA = new Date(a.date || a.timestamp);
                const dateB = new Date(b.date || b.timestamp);
                return dateB - dateA;
              });
          }

          // Calculate stats
          calculateStats();

          // Apply filters (default shows all)
          filteredTransactions = [...transactions];
          currentPage = 1;
          renderTransactions();
          renderPagination();

          // Hide loader
          setTimeout(() => {
            loader.style.opacity = "0";
            setTimeout(() => {
              loader.style.display = "none";
            }, 500);
          }, 500);

          // Initialize chart
          initChart();
        });
      }

      // Calculate transaction statistics
      function calculateStats() {
        let totalDeposits = 0;
        let totalWithdrawals = 0;
        let totalSwaps = 0;
        let totalWinnings = 0;

        transactions.forEach((transaction) => {
          const amount = parseFloat(transaction.amount) || 0;

          if (transaction.type === "deposit") {
            totalDeposits += amount;
          } else if (transaction.type === "withdrawal") {
            totalWithdrawals += amount;
          } else if (transaction.type === "swap") {
            totalSwaps += amount;
          } else if (
            transaction.type === "game" &&
            transaction.result === "win"
          ) {
            totalWinnings += amount;
          }
        });

        // Update DOM
        document.getElementById(
          "totalDeposits"
        ).textContent = `$${totalDeposits.toFixed(2)}`;
        document.getElementById(
          "totalWithdrawals"
        ).textContent = `$${totalWithdrawals.toFixed(2)}`;
        document.getElementById(
          "totalSwaps"
        ).textContent = `$${totalSwaps.toFixed(2)}`;
        document.getElementById(
          "totalWinnings"
        ).textContent = `$${totalWinnings.toFixed(2)}`;
      }

      // Apply filters to transactions
      function applyFilters() {
        const typeFilter = document.getElementById("typeFilter").value;
        const statusFilter = document.getElementById("statusFilter").value;
        const dateFilter = document.getElementById("dateFilter").value;
        const amountFilter = document.getElementById("amountFilter").value;

        filteredTransactions = transactions.filter((transaction) => {
          // Type filter
          if (typeFilter !== "all" && transaction.type !== typeFilter) {
            return false;
          }

          // Status filter
          if (
            statusFilter !== "all" &&
            transaction.status !== statusFilter &&
            !(
              statusFilter === "completed" &&
              transaction.result === "win" &&
              transaction.type === "game"
            )
          ) {
            return false;
          }

          // Date filter
          if (dateFilter !== "all") {
            const transactionDate = new Date(
              transaction.date || transaction.timestamp
            );
            const now = new Date();
            let cutoffDate = new Date();

            switch (dateFilter) {
              case "7d":
                cutoffDate.setDate(now.getDate() - 7);
                break;
              case "30d":
                cutoffDate.setDate(now.getDate() - 30);
                break;
              case "90d":
                cutoffDate.setDate(now.getDate() - 90);
                break;
              case "1y":
                cutoffDate.setFullYear(now.getFullYear() - 1);
                break;
            }

            if (transactionDate < cutoffDate) {
              return false;
            }
          }

          // Amount filter
          if (amountFilter !== "all") {
            const amount = parseFloat(transaction.amount) || 0;
            const [min, max] = amountFilter.includes("+")
              ? [1000, Infinity]
              : amountFilter.split("-").map(Number);

            if (amount < min || amount > max) {
              return false;
            }
          }

          return true;
        });

        currentPage = 1;
        renderTransactions();
        renderPagination();
      }

      // Reset all filters
      function resetFilters() {
        document.getElementById("typeFilter").value = "all";
        document.getElementById("statusFilter").value = "all";
        document.getElementById("dateFilter").value = "all";
        document.getElementById("amountFilter").value = "all";

        filteredTransactions = [...transactions];
        currentPage = 1;
        renderTransactions();
        renderPagination();
      }

      // Render transactions to the table
      function renderTransactions() {
        transactionsBody.innerHTML = "";

        if (filteredTransactions.length === 0) {
          emptyState.style.display = "block";
          return;
        }

        emptyState.style.display = "none";

        // Calculate pagination
        const startIndex = (currentPage - 1) * transactionsPerPage;
        const endIndex = Math.min(
          startIndex + transactionsPerPage,
          filteredTransactions.length
        );
        const paginatedTransactions = filteredTransactions.slice(
          startIndex,
          endIndex
        );

        paginatedTransactions.forEach((transaction) => {
          const row = document.createElement("tr");
          row.innerHTML = createTransactionRow(transaction);
          transactionsBody.appendChild(row);

          // Add click event to view details
          row.addEventListener("click", () => {
            viewTransactionDetails(transaction);
          });
        });
      }

      // Create HTML for a transaction row
      function createTransactionRow(transaction) {
        const amount = parseFloat(transaction.amount) || 0;
        const isPositive =
          transaction.type === "deposit" ||
          (transaction.type === "game" && transaction.result === "win");
        const amountClass = isPositive ? "positive" : "negative";
        const amountSign = isPositive ? "+" : "-";
        const formattedAmount = `${amountSign}$${Math.abs(amount).toFixed(2)}`;

        // Format date
        const transactionDate = new Date(
          transaction.date || transaction.timestamp
        );
        const formattedDate = transactionDate.toLocaleDateString("en-US", {
          month: "short",
          day: "numeric",
          year: "numeric",
        });

        // Determine icon and status
        let iconClass = "";
        let icon = "";
        let statusText = "";
        let statusClass = "";

        switch (transaction.type) {
          case "deposit":
            iconClass = "deposit";
            icon = "fas fa-arrow-down";
            statusText = "Completed";
            statusClass = "completed";
            break;
          case "withdrawal":
            iconClass = "withdrawal";
            icon = "fas fa-arrow-up";
            statusText = transaction.status || "Completed";
            statusClass = transaction.status || "completed";
            break;
          case "swap":
            iconClass = "swap";
            icon = "fas fa-exchange-alt";
            statusText = transaction.status || "Completed";
            statusClass = transaction.status || "completed";
            break;
          case "game":
            iconClass = "game";
            icon = "fas fa-gamepad";
            statusText =
              transaction.result === "win"
                ? "Won"
                : transaction.status || "Lost";
            statusClass =
              transaction.result === "win"
                ? "completed"
                : transaction.status || "failed";
            break;
        }

        // Create description
        let description = "";
        if (transaction.type === "deposit") {
          description = "Deposit";
          if (transaction.method) description += ` (${transaction.method})`;
        } else if (transaction.type === "withdrawal") {
          description = "Withdrawal";
          if (transaction.crypto) description += ` (${transaction.crypto})`;
        } else if (transaction.type === "swap") {
          description = "Currency Swap";
        } else if (transaction.type === "game") {
          description = "Guess & Win";
          if (transaction.crypto)
            description += ` (${
              transaction.crypto.name || transaction.crypto
            })`;
        }

        return `
          <td data-label="Transaction">
            <div class="transaction-type">
              <div class="transaction-icon ${iconClass}">
                <i class="${icon}"></i>
              </div>
              <div class="transaction-details">
                <div class="transaction-title">${description}</div>
                <div class="transaction-subtitle">${formattedDate}</div>
              </div>
            </div>
          </td>
          <td data-label="Amount">
            <div class="transaction-amount ${amountClass}">${formattedAmount}</div>
          </td>
          <td data-label="Date">${formattedDate}</td>
          <td data-label="Status">
            <div class="transaction-status ${statusClass}">${statusText}</div>
          </td>
          <td data-label="Actions">
            <div class="transaction-actions">
              <button class="transaction-btn view-btn" data-id="${transaction.id}">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </td>
        `;
      }

      // Render pagination controls
      function renderPagination() {
        pagination.innerHTML = "";
        const totalPages = Math.ceil(
          filteredTransactions.length / transactionsPerPage
        );

        if (totalPages <= 1) return;

        // Previous button
        const prevBtn = document.createElement("button");
        prevBtn.className = "pagination-btn";
        prevBtn.innerHTML = "<i class='fas fa-chevron-left'></i>";
        prevBtn.disabled = currentPage === 1;
        prevBtn.addEventListener("click", () => {
          if (currentPage > 1) {
            currentPage--;
            renderTransactions();
            renderPagination();
            window.scrollTo({ top: 0, behavior: "smooth" });
          }
        });
        pagination.appendChild(prevBtn);

        // Page numbers
        const maxVisiblePages = 5;
        let startPage = Math.max(
          1,
          currentPage - Math.floor(maxVisiblePages / 2)
        );
        let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

        if (endPage - startPage + 1 < maxVisiblePages) {
          startPage = Math.max(1, endPage - maxVisiblePages + 1);
        }

        if (startPage > 1) {
          const firstBtn = document.createElement("button");
          firstBtn.className = "pagination-btn";
          firstBtn.textContent = "1";
          firstBtn.addEventListener("click", () => {
            currentPage = 1;
            renderTransactions();
            renderPagination();
            window.scrollTo({ top: 0, behavior: "smooth" });
          });
          pagination.appendChild(firstBtn);

          if (startPage > 2) {
            const ellipsis = document.createElement("span");
            ellipsis.className = "pagination-ellipsis";
            ellipsis.textContent = "...";
            pagination.appendChild(ellipsis);
          }
        }

        for (let i = startPage; i <= endPage; i++) {
          const pageBtn = document.createElement("button");
          pageBtn.className = `pagination-btn ${
            i === currentPage ? "active" : ""
          }`;
          pageBtn.textContent = i;
          pageBtn.addEventListener("click", () => {
            currentPage = i;
            renderTransactions();
            renderPagination();
            window.scrollTo({ top: 0, behavior: "smooth" });
          });
          pagination.appendChild(pageBtn);
        }

        if (endPage < totalPages) {
          if (endPage < totalPages - 1) {
            const ellipsis = document.createElement("span");
            ellipsis.className = "pagination-ellipsis";
            ellipsis.textContent = "...";
            pagination.appendChild(ellipsis);
          }

          const lastBtn = document.createElement("button");
          lastBtn.className = "pagination-btn";
          lastBtn.textContent = totalPages;
          lastBtn.addEventListener("click", () => {
            currentPage = totalPages;
            renderTransactions();
            renderPagination();
            window.scrollTo({ top: 0, behavior: "smooth" });
          });
          pagination.appendChild(lastBtn);
        }

        // Next button
        const nextBtn = document.createElement("button");
        nextBtn.className = "pagination-btn";
        nextBtn.innerHTML = "<i class='fas fa-chevron-right'></i>";
        nextBtn.disabled = currentPage === totalPages;
        nextBtn.addEventListener("click", () => {
          if (currentPage < totalPages) {
            currentPage++;
            renderTransactions();
            renderPagination();
            window.scrollTo({ top: 0, behavior: "smooth" });
          }
        });
        pagination.appendChild(nextBtn);
      }

      // View transaction details
      function viewTransactionDetails(transaction) {
        const amount = parseFloat(transaction.amount) || 0;
        const isPositive =
          transaction.type === "deposit" ||
          (transaction.type === "game" && transaction.result === "win");
        const amountClass = isPositive ? "positive" : "negative";
        const amountSign = isPositive ? "+" : "-";
        const formattedAmount = `${amountSign}$${Math.abs(amount).toFixed(2)}`;

        // Format date
        const transactionDate = new Date(
          transaction.date || transaction.timestamp
        );
        const formattedDate = transactionDate.toLocaleString("en-US", {
          month: "short",
          day: "numeric",
          year: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        });

        // Set details
        document.getElementById("detailId").textContent =
          transaction.txId || transaction.id;
        document.getElementById("detailType").textContent =
          transaction.type.charAt(0).toUpperCase() + transaction.type.slice(1);
        document.getElementById("detailAmount").textContent = formattedAmount;
        document.getElementById(
          "detailAmount"
        ).className = `detail-value ${amountClass}`;
        document.getElementById("detailDate").textContent = formattedDate;

        // Set status
        let statusText = "";
        let statusClass = "";
        if (transaction.type === "game") {
          statusText = transaction.result === "win" ? "Won" : "Lost";
          statusClass = transaction.result === "win" ? "completed" : "failed";
        } else {
          statusText = transaction.status || "Completed";
          statusClass = transaction.status || "completed";
        }
        document.getElementById("detailStatus").textContent = statusText;
        document.getElementById("detailStatus").className = statusClass;

        // Set description
        let description = "";
        if (transaction.type === "deposit") {
          description = "Deposit";
          if (transaction.method) description += ` from ${transaction.method}`;
        } else if (transaction.type === "withdrawal") {
          description = "Withdrawal";
          if (transaction.crypto) description += ` to ${transaction.crypto}`;
          if (transaction.address)
            description += ` to ${transaction.address.substring(
              0,
              6
            )}...${transaction.address.substring(
              transaction.address.length - 4
            )}`;
        } else if (transaction.type === "swap") {
          description = "Currency Swap";
          if (transaction.amountNGN && transaction.amountUSD)
            description += ` from ₦${transaction.amountNGN.toLocaleString()} to $${transaction.amountUSD.toFixed(
              2
            )}`;
        } else if (transaction.type === "game") {
          description = "Guess & Win";
          if (transaction.crypto)
            description += ` - ${
              transaction.crypto.name || transaction.crypto
            }`;
        }
        document.getElementById("detailDescription").textContent = description;

        // Set reference
        let reference = "";
        if (transaction.txId) {
          reference = transaction.txId;
        } else if (transaction.reference) {
          reference = transaction.reference;
        } else if (transaction.id) {
          reference = transaction.id;
        }
        document.getElementById("detailReference").textContent = reference;

        // Show modal
        transactionModal.classList.add("active");
      }

      // Export transactions
      function exportTransactions() {
        let exportContent = "";
        const exportDate = new Date().toLocaleDateString("en-US", {
          year: "numeric",
          month: "short",
          day: "numeric",
        });

        switch (selectedFormat) {
          case "csv":
            exportContent = "Type,Amount,Date,Status,Description\n";
            filteredTransactions.forEach((transaction) => {
              const amount = parseFloat(transaction.amount) || 0;
              const isPositive =
                transaction.type === "deposit" ||
                (transaction.type === "game" && transaction.result === "win");
              const amountSign = isPositive ? "+" : "-";
              const formattedAmount = `${amountSign}$${Math.abs(amount).toFixed(
                2
              )}`;

              // Format date
              const transactionDate = new Date(
                transaction.date || transaction.timestamp
              );
              const formattedDate = transactionDate.toLocaleDateString(
                "en-US",
                {
                  month: "short",
                  day: "numeric",
                  year: "numeric",
                }
              );

              // Description
              let description = "";
              if (transaction.type === "deposit") {
                description = "Deposit";
                if (transaction.method)
                  description += ` from ${transaction.method}`;
              } else if (transaction.type === "withdrawal") {
                description = "Withdrawal";
                if (transaction.crypto)
                  description += ` to ${transaction.crypto}`;
              } else if (transaction.type === "swap") {
                description = "Currency Swap";
              } else if (transaction.type === "game") {
                description = "Guess & Win";
                if (transaction.crypto)
                  description += ` - ${
                    transaction.crypto.name || transaction.crypto
                  }`;
              }

              // Status
              let statusText = "";
              if (transaction.type === "game") {
                statusText = transaction.result === "win" ? "Won" : "Lost";
              } else {
                statusText = transaction.status || "Completed";
              }

              exportContent += `"${transaction.type}","${formattedAmount}","${formattedDate}","${statusText}","${description}"\n`;
            });
            break;

          case "pdf":
          case "excel":
          case "print":
            // In a real app, you would generate PDF/Excel or print
            // For this demo, we'll just show a notification
            showNotification(
              "success",
              "Export Started",
              `Your transactions are being prepared for ${selectedFormat.toUpperCase()} export.`
            );
            break;
        }

        if (selectedFormat === "csv") {
          // Create download link
          const blob = new Blob([exportContent], { type: "text/csv" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = `SwiftPurse_Transactions_${exportDate.replace(
            / /g,
            "_"
          )}.csv`;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);

          showNotification(
            "success",
            "Export Complete",
            "Your transactions have been exported to CSV."
          );
        }

        exportModal.classList.remove("active");
      }

      // Initialize transaction chart
      function initChart() {
        if (transactionChart) {
          transactionChart.destroy();
        }

        const ctx = transactionChartCanvas.getContext("2d");
        transactionChart = new Chart(ctx, {
          type: "line",
          data: {
            labels: [],
            datasets: [
              {
                label: "Deposits",
                data: [],
                borderColor: "#38b000",
                backgroundColor: "rgba(56, 176, 0, 0.1)",
                tension: 0.4,
                fill: true,
              },
              {
                label: "Withdrawals",
                data: [],
                borderColor: "#d00000",
                backgroundColor: "rgba(208, 0, 0, 0.1)",
                tension: 0.4,
                fill: true,
              },
              {
                label: "Swaps",
                data: [],
                borderColor: "#9b5de5",
                backgroundColor: "rgba(155, 93, 229, 0.1)",
                tension: 0.4,
                fill: true,
              },
              {
                label: "Game Winnings",
                data: [],
                borderColor: "#f15bb5",
                backgroundColor: "rgba(241, 91, 181, 0.1)",
                tension: 0.4,
                fill: true,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: "top",
                labels: {
                  color: "rgba(255, 255, 255, 0.8)",
                },
              },
              tooltip: {
                mode: "index",
                intersect: false,
                backgroundColor: "rgba(0, 0, 0, 0.8)",
                titleColor: "#ffffff",
                bodyColor: "rgba(255, 255, 255, 0.8)",
                borderColor: "rgba(255, 255, 255, 0.1)",
                borderWidth: 1,
              },
            },
            scales: {
              x: {
                grid: {
                  color: "rgba(255, 255, 255, 0.1)",
                },
                ticks: {
                  color: "rgba(255, 255, 255, 0.6)",
                },
              },
              y: {
                grid: {
                  color: "rgba(255, 255, 255, 0.1)",
                },
                ticks: {
                  color: "rgba(255, 255, 255, 0.6)",
                  callback: function (value) {
                    return "$" + value;
                  },
                },
              },
            },
            interaction: {
              mode: "nearest",
              axis: "x",
              intersect: false,
            },
          },
        });

        // Update with default period (7 days)
        updateChart("7d");
      }

      // Update chart with data for selected period
      function updateChart(period) {
        let days = 7;
        switch (period) {
          case "30d":
            days = 30;
            break;
          case "90d":
            days = 90;
            break;
          case "1y":
            days = 365;
            break;
        }

        const now = new Date();
        const labels = [];
        const depositData = [];
        const withdrawalData = [];
        const swapData = [];
        const gameData = [];

        // Initialize data arrays with zeros
        for (let i = days - 1; i >= 0; i--) {
          const date = new Date();
          date.setDate(now.getDate() - i);
          labels.push(
            date.toLocaleDateString("en-US", { month: "short", day: "numeric" })
          );

          depositData.push(0);
          withdrawalData.push(0);
          swapData.push(0);
          gameData.push(0);
        }

        // Calculate data for each day
        transactions.forEach((transaction) => {
          const transactionDate = new Date(
            transaction.date || transaction.timestamp
          );
          const daysAgo = Math.floor(
            (now - transactionDate) / (1000 * 60 * 60 * 24)
          );

          if (daysAgo >= 0 && daysAgo < days) {
            const amount = parseFloat(transaction.amount) || 0;
            const index = days - 1 - daysAgo;

            switch (transaction.type) {
              case "deposit":
                depositData[index] += amount;
                break;
              case "withdrawal":
                withdrawalData[index] += Math.abs(amount);
                break;
              case "swap":
                swapData[index] += amount;
                break;
              case "game":
                if (transaction.result === "win") {
                  gameData[index] += amount;
                }
                break;
            }
          }
        });

        // Update chart data
        transactionChart.data.labels = labels;
        transactionChart.data.datasets[0].data = depositData;
        transactionChart.data.datasets[1].data = withdrawalData;
        transactionChart.data.datasets[2].data = swapData;
        transactionChart.data.datasets[3].data = gameData;
        transactionChart.update();
      }

      // Show notification
      function showNotification(type, title, message) {
        const notification = document.createElement("div");
        notification.className = `custom-notification ${type}`;
        notification.innerHTML = `
          <div class="notification-icon">
            <i class="fas fa-${
              type === "success"
                ? "check-circle"
                : type === "error"
                ? "times-circle"
                : "exclamation-circle"
            }"></i>
          </div>
          <div class="notification-content">
            <div class="notification-title">${title}</div>
            <div class="notification-message">${message}</div>
          </div>
          <button class="notification-close">
            <i class="fas fa-times"></i>
          </button>
        `;

        document.body.appendChild(notification);

        // Show notification
        setTimeout(() => {
          notification.style.transform = "translateX(0)";
        }, 10);

        // Close button
        const closeBtn = notification.querySelector(".notification-close");
        closeBtn.addEventListener("click", () => {
          notification.style.transform = "translateX(100%)";
          setTimeout(() => {
            notification.remove();
          }, 300);
        });

        // Auto-remove after 5 seconds
        setTimeout(() => {
          notification.style.transform = "translateX(100%)";
          setTimeout(() => {
            notification.remove();
          }, 300);
        }, 5000);
      }

      // Create ripple effect on buttons
      function createRipple(event) {
        const button = event.currentTarget;
        const circle = document.createElement("span");
        const diameter = Math.max(button.clientWidth, button.clientHeight);
        const radius = diameter / 2;

        circle.style.width = circle.style.height = `${diameter}px`;
        circle.style.left = `${
          event.clientX - button.getBoundingClientRect().left - radius
        }px`;
        circle.style.top = `${
          event.clientY - button.getBoundingClientRect().top - radius
        }px`;
        circle.classList.add("ripple");

        const ripple = button.getElementsByClassName("ripple")[0];
        if (ripple) {
          ripple.remove();
        }

        button.appendChild(circle);
      }
    </script>
    <script src="security.js"></script>
  </body>
</html>
